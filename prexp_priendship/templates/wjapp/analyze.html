{% extends "base.html" %}

{% block content%}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.16.1/vis.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.16.1/vis.min.css" rel="stylesheet" type="text/css" />

<style type="text/css">
.network {
	width: 100%;
	height: 400px;
	border: 1px solid lightgray;
}

p.collection-header{
	margin: 0px;
}

.graph-col {
	margin-top: 20px;
}
</style>

<div class="container">
	
	<div class="row">
		
		<div class="graph-col col m4 s12">
			<div id="fep-network" class="network z-depth-1"></div>
			<div class="collection with-header">
				<p class="collection-header center">
					<strong>1st Experiment</strong>
					(N={{fep_n}})
				</p>
				<p href="#!" class="collection-item">Lorem Ipsum</p>
				<p href="#!" class="collection-item">Lorem Ipsum</p>
			</div>	
			<div id="fep-btn-group" class="center">
				<a id="green-btn" class="green waves-effect waves-light btn rel-btn"></a>
				<a id="red-btn" class="red waves-effect waves-light btn rel-btn"></a>
				<a id="grey-btn" class="grey waves-effect waves-light btn rel-btn"></a>
			</div>
		</div>

		<div class="graph-col col m4 s12">
			<div id="sep-network" class="network z-depth-1"></div>
			<div class="collection with-header">
				<p class="collection-header center">
					<strong>2nd Experiment</strong>
					(N={{sep_n}})
				</p>
				<p href="#!" class="collection-item">Lorem Ipsum</p>
				<p href="#!" class="collection-item">Lorem Ipsum</p>
			</div>	
			<div id="sep-btn-group" class="center">
				<a id="green-btn" class="green waves-effect waves-light btn rel-btn"></a>
				<a id="red-btn" class="red waves-effect waves-light btn rel-btn"></a>
				<a id="grey-btn" class="grey waves-effect waves-light btn rel-btn"></a>
			</div>
		</div>

		<div class="graph-col col m4 s12 center">
			<div class="preloader-wrapper small active">
				<div class="spinner-layer spinner-green-only">
					<div class="circle-clipper left">
						<div class="circle"></div>
					</div>
					<div class="gap-patch">
						<div class="circle"></div>
					</div>
					<div class="circle-clipper right">
						<div class="circle"></div>
					</div>
				</div>
			</div>
		</div>

	</div>
	<div class="row center">
		<a href="/" class="btn-floating btn-large waves-effect waves-light"><i class="material-icons">home</i></a>
	</div>
</div>

<script>

function draw_network(container_id, raw_nodes, raw_edges, color_option){
	var container = document.getElementById(container_id);
	var edges = [];
	for(var idx = 0; idx < raw_edges.length; idx++){
		if(color_option == "green-btn"){
			if(raw_edges[idx]["color"]["color"] == "green"){
				edges.push(raw_edges[idx]);
			}
		} else if (color_option == "red-btn"){
			if(raw_edges[idx]["color"]["color"] == "red"){
				edges.push(raw_edges[idx]);
			}
		} else {
			edges = raw_edges;
		}
	}
	var nodes = new vis.DataSet(raw_nodes);
	var edges = new vis.DataSet(edges);

	var data = {
		nodes: nodes,
		edges: edges
	};
	var options = {};
	var network = new vis.Network(container, data, options);
}

function make_network_square(){
	$network = $(".network");
	$network.height($network.width());
	$(".preloader-wrapper").css("margin-top", $network.height()/2-18);
}


var fep_raw_nodes = {{fep_nodes|safe}};
var fep_raw_edges = {{fep_edges|safe}};

var sep_raw_nodes = {{sep_nodes|safe}};
var sep_raw_edges = {{sep_edges|safe}};

$(document).ready(function(){
	make_network_square();
	draw_network("fep-network", fep_raw_nodes, fep_raw_edges, "grey-btn");	
	draw_network("sep-network", sep_raw_nodes, sep_raw_edges, "grey-btn");	
});

$(window).resize(function(){
	make_network_square();
});

$(".rel-btn").click(function(){
	var $id = $(this).parent().attr("id");
	var $color = $(this).attr("id");
	draw_network($id.split("-")[0]+"-network", fep_raw_nodes, fep_raw_edges, $color);	
});

</script>


{% endblock %}
